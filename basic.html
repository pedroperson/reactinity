<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reactinity - Example 1</title>
    <!-- Add some basic css so we don't have to clutter the html for this example -->
    <style>
      * {
        box-sizing: border-box;
      }
      span[re] {
        font-weight: 700;
      }

      .my-page-width {
        width: 100%;
        max-width: 1400px;
        margin-left: auto;
        margin-right: auto;
        padding-left: 2em;
        padding-right: 2em;

        margin-top: 2em;
      }

      @media (max-width: 768px) {
        .my-page-width {
          padding-left: 1em;
          padding-right: 1em;
        }
      }
    </style>
  </head>
  <body>
    <!-- Import the js code however you want -->
    <script src="/basic.js"></script>

    <!-- Keep the ArrayStore templates from showing from the start. is there are better way to do this ? Maybe we shouldn't care and just do it js asap? -->
    <style>
      [re-template] {
        display: none;
      }
    </style>

    <!-- ---------------------------------------------------------------- -->
    <!-- INITIALIZE REACTINITY ------------------------------------------ -->
    <!-- ---------------------------------------------------------------- -->
    <script>
      const reactinity = new Reactinity();
      reactinity.defaultInit();
    </script>

    <!-- ---------------------------------------------------------------- -->
    <!-- 1. BASIC EXAMPLES ---------------------------------------------- -->
    <!-- We'll start with a simple counter example----------------------- -->
    <script>
      // The counter
      // Create a basic integer store
      const countStore = reactinity.newStore("count", 0);
      // Write some functions that interact with the store
      const Counter = {
        up: () => countStore.update((v) => v + 1),
        down: () => countStore.update((v) => v - 1),
        reset: () => countStore.set(0),
      };

      // Create a store whose value depends on another
      const relatedStore = reactinity.newStore("related", countStore.value);
      countStore.subscribe((v) => relatedStore.set(v + 100));

      // You can also use transforms for such situations. A transform takes in the current value of a store and feeds it through a function. Here we are naming a transform "plus200" so we can reference it in the dom.
      reactinity.newTransform("plus200", (v) => v + 200);
    </script>

    <section class="my-page-width">
      <div>
        Count = <span re="count"></span>;
        <span>Count + 100 = <span re="related"></span>;</span>
        <span
          >Count + 200 = <span re="count" re-transform="plus200"></span>;</span
        >
      </div>
      <button onclick="Counter.down()">-1</button>
      <button onclick="Counter.up()">+1</button>
      <button onclick="Counter.reset()">Reset</button>
    </section>

    <!-- ---------------------------------------------------------------- -->
    <!-- OBJECT EXAMPLE ------------------------------------------------- -->
    <!-- ---------------------------------------------------------------- -->
    <script>
      // Here we
      const obj = reactinity.newStore("user", {
        name: "Michael Travis",
        joined: 1710853950,
        // Using an object inside of another just to show off
        interactions: {
          lastClicked: 0,
        },
      });

      // Imagine a function that updates specific fields of an object and displays the changes immediately
      function updateInteraction() {
        obj.update((v) => {
          v.interactions.lastClicked = Date.now();
          return v;
        });
      }
    </script>

    <section class="my-page-width">
      <!-- Target store fields directly using object notation -->
      <div>Name: <span re="user.name"></span></div>
      <!-- Transform objet field values directly -->
      <div>Joined: <span re="user.joined" re-transform="date"></span></div>
      <!-- Reactinity comes with some default transforms you can use. -->
      <div>
        Last interaction:
        <span re="user.interactions.lastClicked" re-transform="time"></span>
      </div>
      <button onclick="updateInteraction()">Update interaction</button>
    </section>
  </body>
</html>
